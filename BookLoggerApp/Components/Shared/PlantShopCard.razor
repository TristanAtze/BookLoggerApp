@using BookLoggerApp.Core.Models

<div class="plant-shop-card @(IsSelected ? "selected" : "") @(IsLockedByLevel ? "locked" : "")" @onclick="OnSelect" style="display: flex; flex-direction: column;">
    <!-- Plant Image -->
    <div class="plant-card-image">
        <img src="@Species.ImagePath" alt="@Species.Name" />
    </div>

    <!-- Plant Info -->
    <div class="plant-card-body">
        <h3 class="plant-card-title">@Species.Name</h3>
        <p class="plant-card-description">@Species.Description</p>

        <!-- Stats -->
        <div class="plant-card-stats">
            <div class="stat-mini">
                <span class="stat-icon">ðŸ“Š</span>
                <span>Lv. @Species.MaxLevel</span>
            </div>
            <div class="stat-mini">
                <span class="stat-icon">ðŸ’§</span>
                <span>@Species.WaterIntervalDays d</span>
            </div>
            <div class="stat-mini">
                <span class="stat-icon">âš¡</span>
                <span>@Species.GrowthRate.ToString("0.0")x</span>
            </div>
        </div>

        <!-- Price -->
        <div class="plant-card-footer">
            <span class="plant-cost @(UserCoins >= CurrentPrice ? "affordable" : "expensive")">
                ðŸª™ @CurrentPrice
            </span>
            @if (IsLockedByLevel)
            {
                <span class="buy-label locked">Unlocks at Lv. @Species.UnlockLevel</span>
            }
            else if (UserCoins >= CurrentPrice)
            {
                <span class="buy-label">Click to Buy</span>
            }
            else
            {
                <span class="buy-label locked">Need @(CurrentPrice - UserCoins) more</span>
            }
        </div>
    </div>

    <!-- Locked Overlay for entire card -->
    @if (IsLockedByLevel)
    {
        <div class="locked-overlay-full">
            <div class="lock-content">
                <span class="lock-icon-large">ðŸ”’</span>
                <span class="lock-text">Requires Level @Species.UnlockLevel</span>
            </div>
        </div>
    }
</div>

@code {
    [Parameter] public PlantSpecies Species { get; set; } = null!;
    [Parameter] public int UserCoins { get; set; }
    [Parameter] public int UserLevel { get; set; }
    [Parameter] public int CurrentPrice { get; set; }
    [Parameter] public bool IsSelected { get; set; }
    [Parameter] public EventCallback OnSelect { get; set; }

    private bool IsLockedByLevel => UserLevel < Species.UnlockLevel;
}
